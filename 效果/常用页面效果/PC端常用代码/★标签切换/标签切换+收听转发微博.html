<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>收听转发微博</title>
	<style>
	body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,form,fieldset,input,textarea,p,blockquote,th,td{margin:0;padding:0;}
	table{border-collapse:collapse;border-spacing:0;}
	address,caption,cite,code,dfn,em,strong,th,var{font-weight:400;font-style:normal;}
	ol,ul{list-style:none;}
	caption,th{text-align:left;}
	h1,h2,h3,h4,h5,h6{font-weight:400;font-size:100%;}
	q:before,q:after{content:'';}
	fieldset,img,abbr,acronym{border:0;}
	.c:before,.c:after{content:"";display:table;}
	.c:after{clear:both;}
	.c{zoom:1;}

		.wrap {width: 1000px;margin: 0 auto;}
			.list li {float: left;width: 100px;height: 20px;line-height: 20px;text-align: center;background-color: #ccc;cursor: pointer;}
			.list .on {background-color: #f00;cursor: default;}
	</style>
</head>
<body>
	<div class="wrap">
		<ul class="list c">
			<li class="tab on">标签一</li>
			<li class="tab">标签二</li>
			<li class="tab">标签三</li>
			<li class="tab">标签四</li>
			<li class="tab">标签五</li>
		</ul>
		<div class="wb" id="wb">
			微博内容一
		</div>
		<a href="javascript:;" onclick="checkAll();share();" class="btn">收听转发微博</a>
	</div>
	<script type="text/javascript" src="http://ossweb-img.qq.com/images/js/login/loginmanagerv2_min.js"></script>
	<script src="http://ossweb-img.qq.com/images/js/comm/checkAll.min.js"></script>
	<script>
		//根据类名获取元素
		var GLOBAL = {};
		GLOBAL.namespace = function (str) {
		    var arr = str.split('.'),
		        o = GLOBAL;
		    for (i = (arr[0] == "GLOBAL") ? 1 : 0; i < arr.length; i++) {
		        o[arr[i]] = o[arr[i]] || {};
		        o = o[arr[i]];
		    }
		};
		GLOBAL.namespace("Dom");
		GLOBAL.Dom.getElementsByClassName = function (str, root, tag) {
		    if (root) {
		        root = (typeof root == "string") ? document.getElementById(root) : root;
		    } else {
		        root = document.body;
		    }
		    tag = tag || '*';
		    var els = root.getElementsByTagName(tag),
		        arr = [];
		    for (var i = 0, leng = els.length; i < leng; i++) {
		        var k = els[i].className.split(' ');
		        for (j = 0, len = k.length; j < len; j++) {
		            if (k[j] == str) {
		                arr.push(els[i]);
		                break;
		            }
		        }
		    }
		    return arr;
		}

		//根据ID获取元素
		function gE(e) {
		    return (typeof (e) == "object") ? e : document.getElementById(e)
		}

		//标签切换
		function setTab() {
		    var tab = GLOBAL.Dom.getElementsByClassName("tab");
		    var wb = ["微博内容一","微博内容二", "微博内容三", "微博内容四", "微博内容五"];
		    for (var i = 0; i < tab.length; i++) {
		        tab[i]._index = i;
		        tab[i].onclick = function () {
		            if (tab[this._index].className!="tab on") {
		                for (var j = 0; j < tab.length; j++) {
		                    tab[j].className = "tab";
		                }
		                this.className = "tab on"
		                gE("wb").innerHTML = wb[this._index];
		            }

		        }
		    }
		};
		setTab();

		//分享微博
		function share() {
			  var ct_wb = gE("wb").innerHTML;
			  var _url = encodeURI(document.location);
			  var _title = encodeURI(document.title);
			  var _pic = encodeURI("");//（例如：var _pic='图片url1|图片url2|图片url3....）
			  var _appkey = encodeURI(""); //你从腾讯获得的appkey
			  var _summary = encodeURIComponent(ct_wb); //需要转播的内容
			  var _t = _summary + encodeURI("活动地址：");
			  var _u = 'http://v.t.qq.com/share/share.php?title=' + _t + '&url=' + _url + '&appkey=' + _appkey + '&pic=' + _pic;
			  window.open(_u, '', 'width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		};

		//收听微博
		function checkAll(){
			followAll(["woz"],function(){
				alert('收听成功');
			},function(){
				alert('收听失败，请刷新后重试~~');
			})
		}
	</script>
</body>
</html>