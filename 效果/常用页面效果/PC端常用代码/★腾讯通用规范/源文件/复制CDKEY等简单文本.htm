<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="all" />
<meta name="author" content="Tencent-TGideas" />
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>复制CDKEY等简单文本</title>
<style type="text/css">
@charset "gb2312";
body,h1,h2,h3,h4,h5,h6,hr,p,dl,dt,dd,ul,ol,li,form,fieldset,legend,button,input,textarea,th,td{margin:0;padding:0}
body,button,input,select,textarea{font:12px/1.5 tahoma,arial,'\5b8b\4f53',sans-serif}
h1,h2,h3,h4,h5,h6{font-size:100%}
ul{list-style:none;}
.wrap{ margin:0 auto;}
#header,#main{margin:5px auto;padding:30px;width:800px;background:#f9f9f9; border:1px solid #ccc;line-height:22px;}
#header{height:30px;}
#main{height:200px;}
ol{margin:0;padding:0;}
li{margin-left:40px;}

.carouselContent{width:400px;height:100px;border:1px #000 solid;}
</style>
</head>
<body>
<div class="wrap">
	<div id="header">
		<h1>复制CDKEY等简单文本</h1>
	</div>
	<div id="main">
    	<h2>一、使用说明：</h2>
		<ol>
			<li>可用来复制CDKEY等简单的文本，注意修改ID及相应的提示即可，详情请查看页面源代码</li>
			<li>示例演示：CDKEY：<span id="cdkey-ct">88888888888888</span> <a href="javascript:copyToClipboard()">复制</a></li>
		</ol>
	</div>
</div>
<script>
function copyToClipboard() {
    if (window.clipboardData) {
        window.clipboardData.clearData();
        window.clipboardData.setData("Text", document.getElementById('cdkey-ct').innerHTML);

    } else if (navigator.userAgent.indexOf("Opera") != -1) {
        window.location = txt;
    } else if (window.netscape) {
        try {
            netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
        } catch (e) {
            alert("被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'");
        }
        var clip = Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);
        if (!clip)
            return;
        var trans = Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);
        if (!trans)
            return;
        trans.addDataFlavor('text/unicode');
        var str = new Object();
        var len = new Object();
        var str = Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);
        var copytext = txt;
        str.data = copytext;
        trans.setTransferData("text/unicode", str, copytext.length * 2);
        var clipid = Components.interfaces.nsIClipboard;
        if (!clip)
            return false;
        clip.setData(trans, null, clipid.kGlobalClipboard);
    }
    else {
        alert("对不起，您的浏览器不能使用复制功能，请手动复制！");
        return;
    }
    alert("CDKEY已经复制到剪贴板，赶紧去CDKEY兑换中心兑换礼包吧！");
}
</script>
</body>
</html>
